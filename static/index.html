<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ApplyDraft - Job Application Kit</title>
  <link rel="stylesheet" href="/static/style.css?v=6">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" async id="supabaseScript"></script>
</head>
<body>

<!-- ═══ Loading Indicator (shown until init completes) ════ -->
<div id="loadingScreen" style="display:flex;align-items:center;justify-content:center;height:100vh;color:#8b90a5;font-size:16px;">Loading...</div>

<!-- ═══ Login Page ════════════════════════════════════════ -->
<div id="loginPage" style="display:none">
  <div class="login-container">
    <h1>ApplyDraft</h1>
    <p class="login-subtitle">AI-powered job application automation</p>
    <div class="login-buttons">
      <button class="btn btn-google" onclick="loginWithGoogle()">
        Sign in with Google
      </button>
      <button class="btn btn-microsoft" onclick="loginWithMicrosoft()">
        Sign in with Microsoft
      </button>
    </div>
  </div>
</div>

<!-- ═══ App (shown after login) ══════════════════════════ -->
<div id="appContainer" style="display:none">

  <!-- ═══ Top Bar (user info + credits) ════════════════════ -->
  <div class="top-bar" id="topBar">
    <div class="top-bar-left">
      <span class="app-name">ApplyDraft</span>
    </div>
    <div class="top-bar-right">
      <span class="credits-display" id="creditsDisplay">0 credits</span>
      <button class="btn btn-sm btn-buy" onclick="buyCredits()">Buy Credits</button>
      <span class="user-email" id="userEmail"></span>
      <button class="btn btn-sm btn-logout" onclick="logout()">Sign Out</button>
    </div>
  </div>

  <!-- ═══ Tab Bar ════════════════════════════════════════════ -->
  <div class="tab-bar" id="tabBar">
    <div class="tab-add" id="addProjectBtn" title="New Project">+</div>
  </div>

  <!-- ═══ Main Content ══════════════════════════════════════ -->
  <div class="main" id="mainContent">
    <div class="empty-state" id="emptyState">
      <h2>Job Application Kit</h2>
      <p>Create a project to get started</p>
      <button class="btn btn-primary" onclick="promptNewProject()">+ New Project</button>
    </div>
  </div>

</div>

<!-- ═══ Progress Modal ═══════════════════════════════════ -->
<div class="progress-overlay" id="progressOverlay" style="display:none">
  <div class="progress-modal">
    <h3 id="progressTitle">Processing...</h3>
    <div class="progress-bar-wrap">
      <div class="progress-bar-fill" id="progressBar"></div>
    </div>
    <div class="progress-status" id="progressStatus"></div>
    <div class="progress-detail" id="progressDetail"></div>
    <div class="progress-steps" id="progressSteps"></div>
  </div>
</div>

<!-- ═══ Celebration Modal ═══════════════════════════════════ -->
<div class="celebration-overlay" id="celebrationOverlay" style="display:none">
  <div class="celebration-modal">
    <div class="celebration-checkmark">
      <svg viewBox="0 0 52 52" class="checkmark-svg">
        <circle cx="26" cy="26" r="25" fill="none" class="checkmark-circle"/>
        <path fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" class="checkmark-check"/>
      </svg>
    </div>
    <h2 class="celebration-title" id="celebrationTitle">All Done!</h2>
    <p class="celebration-msg" id="celebrationMsg">Your applications have been generated successfully.</p>
    <div class="celebration-stats" id="celebrationStats"></div>
    <button class="btn btn-primary celebration-close" onclick="hideCelebration()">Continue</button>
  </div>
  <div class="confetti-container" id="confettiContainer"></div>
</div>

<!-- ═══ Toast Container ═══════════════════════════════════ -->
<div class="toast-container" id="toasts"></div>

<script src="/static/app.js?v=8"></script>
</body>
</html>
